<Page x:Class="BlackFlag.Views.EcuScannerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="ECU Scanner"
      Background="{DynamicResource BackgroundBrush}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" Text="ðŸ”Œ ECU SCANNER" FontSize="24" FontWeight="Bold" 
                   Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,20"/>
        
        <Border Grid.Row="1" Style="{DynamicResource CardStyle}" Margin="0,0,15,0">
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="StartScanBtn" Content="â–¶ START SCAN" 
                            Style="{DynamicResource PrimaryButtonStyle}"
                            Click="StartScan_Click" Width="150"/>
                    <Button x:Name="StopScanBtn" Content="â¹ STOP" 
                            Style="{DynamicResource ButtonStyle}"
                            Click="StopScan_Click" Width="100" Margin="10,0,0,0" IsEnabled="False"/>
                </StackPanel>
                
                <ProgressBar x:Name="ScanProgress" Margin="0,15,0,0" Height="10"/>
                <TextBlock x:Name="ScanStatus" Text="Ready to scan" 
                           Foreground="{DynamicResource SecondaryForeground}" Margin="0,10,0,0"/>
            </StackPanel>
        </Border>
        
        <Border Grid.Row="2" Style="{DynamicResource CardStyle}" Margin="0,20,15,0">
            <StackPanel>
                <TextBlock Text="DETECTED MODULES" FontWeight="Bold" 
                           Foreground="{DynamicResource AccentBrush}" Margin="0,0,0,15"/>
                
                <ListBox x:Name="ModulesList" Background="Transparent" BorderThickness="0"
                         ItemsSource="{Binding DetectedModules}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" 
                                    Padding="15" Margin="0,0,0,10" CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="{Binding ModuleName}" FontWeight="Bold" 
                                                   Foreground="{DynamicResource ForegroundBrush}"/>
                                        <TextBlock Foreground="{DynamicResource SecondaryForeground}">
                                            <Run Text="Address: "/><Run Text="{Binding Address}"/>
                                            <Run Text=" | Protocol: "/><Run Text="{Binding Protocol}"/>
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <Ellipse Grid.Column="1" Width="12" Height="12" 
                                             Fill="{Binding StatusColor}" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                
                <TextBlock x:Name="EmptyMessage" Text="No modules detected. Start a scan to find ECUs." 
                           Foreground="{DynamicResource SecondaryForeground}" 
                           HorizontalAlignment="Center" Margin="0,20,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</Page>
